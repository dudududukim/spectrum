<!-- Gallery Track Component -->
<!-- Horizontal scrolling gallery showing recent films -->
{% assign animation_duration = site.sections.gallery_track.animation_duration | default: 45 %}

<style>
    .gallery-track {
        animation: scroll-left {{ animation_duration }}s linear infinite !important;
    }
</style>

<section class="gallery-track-preview">
    <div class="section-header">
        <h2 class="section-title">Recent Films</h2>
        <p class="section-description">Latest photography from my collection</p>
    </div>

    <div class="section-content">
        <div class="gallery-track-container">
            <div class="gallery-track" id="gallery-track">
                {% assign image_extensions = "jpg,jpeg,png,webp,JPG,JPEG,PNG,WEBP" | split: "," %}
                {% assign films_images = site.static_files | where_exp: "file", "file.path contains '/assets/images/films/'" %}
                {% assign image_count = site.sections.gallery_track.image_count | default: 6 %}
                {% assign recent_films = films_images | limit: image_count %}

                <!-- Generate gallery items with seamless loop duplication -->
                {% for i in (1..2) %}
                    {% for file in recent_films %}
                        {% assign file_ext = file.extname | remove: '.' %}
                        {% if image_extensions contains file_ext %}
                            {% assign image_name = file.name | remove: file.extname %}
                            {% assign image_path = file.path | relative_url %}

                            <div class="gallery-item">
                                <a href="{{ '/films/' | relative_url }}" class="gallery-link" aria-label="View {{ image_name | replace: '-', ' ' | capitalize }} in gallery">
                                    <img
                                        src="{{ image_path }}"
                                        alt="{{ image_name | replace: '-', ' ' | capitalize }}"
                                        class="gallery-image"
                                        loading="lazy"
                                        decoding="async"
                                    />
                                    <div class="gallery-overlay">
                                        <div class="gallery-info">
                                            <span class="gallery-title">{{ image_name | replace: '-', ' ' | capitalize }}</span>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% endfor %}
            </div>
        </div>

        <div class="section-footer">
            <a href="{{ '/films/' | relative_url }}" class="section-button">
                View All Films
                <span class="btn-icon">â†’</span>
            </a>
        </div>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const galleryTrack = document.getElementById('gallery-track');
    if (!galleryTrack) return;

    let isPaused = false;

    // Pause animation on hover
    galleryTrack.addEventListener('mouseenter', function() {
        isPaused = true;
        galleryTrack.style.animationPlayState = 'paused';
    });

    // Resume animation on mouse leave
    galleryTrack.addEventListener('mouseleave', function() {
        isPaused = false;
        galleryTrack.style.animationPlayState = 'running';
    });

    // Pause animation when any gallery item is hovered
    const galleryItems = galleryTrack.querySelectorAll('.gallery-item');
    galleryItems.forEach(item => {
        item.addEventListener('mouseenter', function() {
            isPaused = true;
            galleryTrack.style.animationPlayState = 'paused';
        });

        item.addEventListener('mouseleave', function() {
            isPaused = false;
            galleryTrack.style.animationPlayState = 'running';
        });
    });
});
</script>
